<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ü–ª–∞–Ω–µ—Ç–∞—Ä–Ω–∏–π –µ–∫–æ–ª–æ–≥—ñ—á–Ω–∏–π OSINT</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;background:#000;color:#9fe7ff;font-family:"Courier New",monospace}
canvas{position:fixed;inset:0;z-index:0}
.wrapper{position:relative;z-index:2;padding:16px;display:flex;flex-direction:column;gap:16px}
.title{color:#4dd2ff;letter-spacing:2px;font-size:18px}
.panel{border:1px solid #4dd2ff;padding:12px;background:rgba(0,0,0,.75)}
.row{display:flex;justify-content:space-between;font-size:13px;margin-bottom:6px}
.bar{width:60%;height:6px;border:1px solid #4dd2ff}
.fill{height:100%;background:#4dd2ff;transition:width 1s}
.alert{color:#ff4d4d;animation:blink 1s infinite}
@keyframes blink{50%{opacity:.4}}
#map{height:360px;border:1px solid #4dd2ff;margin-top:10px}
.footer{font-size:10px;opacity:.4;text-align:center}
</style>
</head>

<body>

<canvas id="bg"></canvas>

<div class="wrapper">
  <div class="title">–ü–õ–ê–ù–ï–¢–ê–†–ù–ò–ô –ï–ö–û–õ–û–ì–Ü–ß–ù–ò–ô OSINT</div>

  <div class="panel">
    <div class="row">–ü–û–ñ–ï–ñ–Ü<div class="bar"><div id="fire" class="fill"></div></div></div>
    <div class="row">–ü–û–í–ï–ù–Ü<div class="bar"><div id="flood" class="fill"></div></div></div>
    <div class="row">–®–¢–û–†–ú–ò<div class="bar"><div id="storm" class="fill"></div></div></div>
    <div class="row">–ë–Ü–û–°–§–ï–†–ê<div class="bar"><div id="bio" class="fill"></div></div></div>
    <div class="row alert" id="anomaly">–ü–û–õ–ï –ê–ù–û–ú–ê–õ–Ü–ô: –ê–ù–ê–õ–Ü–ó‚Ä¶</div>

    <div id="map"></div>
  </div>

  <div class="footer">ibonarium.ecology ¬∑ OSINT –±–µ–∑ —Ñ–∞–ª—å—à—ñ</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* ===== BACKGROUND ===== */
const c=document.getElementById("bg"),x=c.getContext("2d");
let W,H,P=[];
function resize(){
  W=c.width=innerWidth;H=c.height=innerHeight;
  P=Array.from({length:200},()=>({x:Math.random()*W,y:Math.random()*H,z:Math.random()*W}));
}
resize();addEventListener("resize",resize);
(function draw(){
  x.fillStyle="#000";x.fillRect(0,0,W,H);
  P.forEach(p=>{
    p.z-=0.2;if(p.z<1)p.z=W;
    let k=120/p.z;
    let px=(p.x-W/2)*k+W/2;
    let py=(p.y-H/2)*k+H/2;
    if(px>0&&py>0&&px<W&&py<H)x.fillRect(px,py,2,2);
  });
  requestAnimationFrame(draw);
})();

/* ===== MAP ===== */
const map=L.map("map",{zoomControl:false}).setView([20,0],2);
L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png").addTo(map);

/* üî• FIRE ‚Äî NASA FIRMS */
const fireLayer=L.tileLayer(
  "https://firms.modaps.eosdis.nasa.gov/mapserver/wms/fires/viirs_snpp_24h?SERVICE=WMS&REQUEST=GetMap&VERSION=1.1.1&LAYERS=fires&FORMAT=image/png&TRANSPARENT=true&SRS=EPSG:3857&BBOX={bbox-epsg-3857}&WIDTH=256&HEIGHT=256",
  {opacity:.7}
).addTo(map);

/* üåä FLOOD ‚Äî GDACS */
const floodLayer=L.tileLayer.wms(
  "https://www.gdacs.org/gdacsapi/api/polygons/getmap",
  {layers:"FL",transparent:true,opacity:.6}
).addTo(map);

/* ===== GDACS EVENTS (REAL DATA) ===== */
async function updateEvents(){
  const res=await fetch("https://www.gdacs.org/xml/rss.xml");
  const text=await res.text();
  const fires=(text.match(/Fire/g)||[]).length;
  const floods=(text.match(/Flood/g)||[]).length;
  const storms=(text.match(/Cyclone|Storm/g)||[]).length;

  fire.style.width=Math.min(fires*10,100)+"%";
  flood.style.width=Math.min(floods*15,100)+"%";
  storm.style.width=Math.min(storms*20,100)+"%";

  const score=fires+floods+storms;
  anomaly.textContent=
    score>12?"–ü–û–õ–ï –ê–ù–û–ú–ê–õ–Ü–ô: –ö–†–ò–¢–ò–ß–ù–ï":
    score>6 ?"–ü–û–õ–ï –ê–ù–û–ú–ê–õ–Ü–ô: –ê–ö–¢–ò–í–ù–ï":
             "–ü–û–õ–ï –ê–ù–û–ú–ê–õ–Ü–ô: –°–¢–ê–ë–Ü–õ–¨–ù–ï";
}

updateEvents();
setInterval(updateEvents,300000);
</script>

</body>
</html>
